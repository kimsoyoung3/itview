<!DOCTYPE html>
<html lang="kr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>갤러리 등록/수정</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<main class="container mt-5">
    <h2 th:text="${galleryDTO.id != null ? '갤러리 수정' : '갤러리 등록'}"></h2>

    <!-- 갤러리 등록/수정 폼 -->
<!--    <form th:action="@{${galleryDTO.id != null ? '/content/' + contentId + '/gallery' : '/content/' + contentId + '/gallery'}}" method="post">-->
    form th:action="@{/content/{contentId}/gallery(contentId=${contentId})}" method="post">
        <!-- 갤러리 ID (수정 시에만 필요) -->
        <input type="hidden" th:name="id" th:value="${galleryDTO.id != null ? galleryDTO.id : ''}" />

        <!-- 컨텐츠 ID -->
        <input type="hidden" th:name="contentId" th:value="${contentId}" />

        <!-- 사진 URL -->
        <div class="mb-3">
            <label class="form-label">Photo</label>
            <input type="text" class="form-control" name="photo"
                   th:value="${galleryDTO != null ? galleryDTO.photo : ''}" required/>
<!--            <label for="photo" class="form-label">사진 URL</label>            -->
<!--            <input type="text" id="photo" name="photo" class="form-control"-->
<!--                   th:value="${galleryDTO.photo}" required />-->
        </div>

        <div class="mb-3">
            <button type="submit" class="btn btn-primary">
                <span th:text="${galleryDTO.id != null ? '수정' : '등록'}">저장</span>
            </button>
            <a th:href="@{'/content/' + ${contentId} + '/gallery'}" class="btn btn-secondary ms-2">목록</a>
        </div>
    </form>

    <!-- Flash 메시지 출력 -->
    <div th:if="${message}" class="alert alert-success" role="alert" th:text="${message}"></div>

    <!-- 갤러리 목록 테이블 -->
    <table class="table table-bordered mt-3">
        <thead class="table-light">
        <tr>
            <th>ID</th>
            <th>사진 URL</th>
            <th>작업선택</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="gallery : ${galleryList}">
            <td th:text="${gallery.id}">1</td>
            <td th:text="${gallery.photo}">사진 URL</td>
            <td>
                <!-- 수정 버튼 -->
                <a th:href="@{'/content/' + ${contentId} + '/gallery?id=' + ${gallery.id}}"
                   class="btn btn-sm btn-warning">✏ 수정</a>

                <!-- 삭제 버튼 (폼 방식으로 galleryId 전달) -->
                <form th:action="@{'/content/' + ${contentId} + '/gallery/delete'}" method="post" style="display:inline;">
                    <input type="hidden" name="galleryId" th:value="${gallery.id}" />
                    <button type="submit" class="btn btn-sm btn-danger">🗑 삭제</button>
                </form>
            </td>
        </tr>
        <tr th:if="${galleryList == null or #lists.isEmpty(galleryList)}">
            <td colspan="4" class="text-center">등록된 갤러리가 없습니다.</td>
        </tr>
        </tbody>
    </table>

</main>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
